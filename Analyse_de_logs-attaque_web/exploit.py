with open("ch13.txt", "r") as f:
    sec = []
    secStr = ""
    cvtStr = ""
    rstStr = ""

    # Lecture des secondes depuis les logs
    for line in f:
        sec.append(int(line.split(" ")[3].split(":")[-1]))

    # Calcul des differences de temps entre les requetes
    secDiffs = []
    for i in range(len(sec) - 1):
        secRst = sec[i + 1] - sec[i]
        if secRst < 0:
            secRst += 60  # Correction pour le passage Ã  la minute suivante
        secDiffs.append(secRst)

    # Transformation en binaire en fonction du delai 
    for i in range(0, len(secDiffs), 4):
        if i + 3 < len(secDiffs):  # Assurer qu'on ne depasse pas la liste
            for j in range(3):
                if secDiffs[i + j] == 0:
                    cvtStr += "00"
                elif secDiffs[i + j] == 2:
                    cvtStr += "01"
                elif secDiffs[i + j] == 4:
                    cvtStr += "10"
                elif secDiffs[i + j] == 6:
                    cvtStr += "11"
            
            # Gestion du bit unique dans la 4e requete
            if secDiffs[i + 3] == 2:
                cvtStr += "0"
            elif secDiffs[i + 3] == 4:
                cvtStr += "1"
            
            cvtStr += "\n"

    # Conversion de la chaine binaire en texte ASCII
    for bin_str in cvtStr.strip().split("\n"):
        rstStr += chr(int(bin_str, 2))

    print("Mot de passe extrait :", rstStr)
